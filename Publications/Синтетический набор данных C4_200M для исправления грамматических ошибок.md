Задача исправления грамматических ошибок (Grammatical Error Correction, GEC) заключается в моделировании грамматических и других типов ошибок в текстах для того, чтобы предложить [поправки в грамматике и правописании](https://support.google.com/docs/answer/57859?hl=en&co=GENIE.Platform%3DDesktop), которые смогут улучшить качество письменного вывода в документах, электронных письмах, сообщениях в блогах и даже в неформальных чатах. За последние 15 лет были достигнуты существенные успехи в задаче GEC, что в значительной степени можно объяснить [переосмыслением проблемы как задачи «перевода»](https://aclanthology.org/P06-1032/). Когда этот подход был представлен, например, в Google Docs, он привел к [значительному увеличению](https://cloud.google.com/blog/products/productivity-collaboration/using-neural-machine-translation-to-correct-grammatical-in-google-docs) числа принятых предложений по исправлению грамматики.

Однако одной из самых больших проблем для моделей GEC является недостаток данных. В отличие от других задач [обработки естественного языка](https://en.wikipedia.org/wiki/Natural_language_processing) (Natural Language Processing, NLP), таких как [распознавание речи](https://en.wikipedia.org/wiki/Speech_recognition) и [машинный перевод](https://en.wikipedia.org/wiki/Machine_translation), для GEC доступно очень мало обучающих данных, даже для таких ресурсоемких языков, как английский. Обычно эта проблема решается созданием синтетических данных с использованием ряда методов, от основанных на эвристике случайных «исправлений» на уровне слов или символов до подходов, основанных на моделях. Однако такие методы имеют тенденцию быть упрощенными и не отражают истинное распределение типов ошибок у реальных пользователей.

В статье «[Synthetic Data Generation for Grammatical Error Correction with Tagged Corruption Models](https://aclanthology.org/2021.bea-1.4/)», поданной на [EACL 16th Workshop on Innovative Use of NLP for Building Educational Applications](https://sig-edu.org/bea/current), авторы представили *тегированные модели ухудшения качества текстов* (tagged corruption models). Вдохновленные популярной техникой синтезирования данных обратным переводом для задачи машинного перевода, авторы создали поход, который позволяет полностью контролировать создание синтетических данных, обеспечивая разнообразные выходные данные, которые более соответствуют распределению ошибок, наблюдаемому на практике. Были использованы тегированные модели ухудшения качества текста для создания нового [набора данных из 200 миллионов предложений](https://github.com/google-research-datasets/C4_200M-synthetic-dataset-for-grammatical-error-correction), опубликованного для того, чтобы предоставить исследователям реалистичные данные для предварительного обучения моделей для задачи GEC. Интегрировав этот новый набор данных в свой пайплайн обучения, авторы смогли значительно улучшить базовые показатели GEC.

# Тегированные модели ухудшения качества текста

Идея применения традиционной модели ухудшения качества для задачи GEC состоит в том, чтобы начать с грамматически правильного предложения, а затем «испортить» его, добавив ошибки. Такую модель можно легко обучить, поменяв местами исходные и целевые предложения в существующих наборах данных GEC — метод, который, как показали [предыдущие исследования](https://aclanthology.org/D19-1119.pdf), может быть очень эффективным для создания улучшенных наборов данных GEC.

![image1](https://habrastorage.org/webt/dq/p1/qq/dqp1qqtwx24n6ovcjbpsprftqug.png)

*Обычная модель ухудшения качества текста генерирует грамматически неверное предложение (выделено красным) из правильного предложения (выделено зеленым).*

Предлагаемая авторами модель ухудшения качества с использованием тегов основана на следующей идее: в качестве входных данных используется грамматически правильное предложение вместе с тегом, описывающим тип ошибки, которую необходимо воспроизвести. Затем модель генерирует грамматически неправильную версию входного предложения, содержащую данный тип ошибки. Выбор разных типов ошибок для разных предложений увеличивает разнообразие сгенерированных ошибочных предложений по сравнению с обычной моделью ухудшения качества.

![image3](https://habrastorage.org/webt/gx/5n/y6/gx5ny6y74lg7vpkgjutjsl_nbam.png)

*Тегированные модели генерируют предложения с ошибками (красный) для грамматически правильного входного предложения (зеленый) в зависимости от тега типа ошибки. Ошибка детерминатива может привести к отбрасыванию артикля «а», тогда как ошибка склонения существительного может привести к неправильной форме множественного числа слова «sheep».*

Чтобы использовать эту модель для генерации данных, авторы сначала случайным образом выбрали 200 миллионов грамматически правильных предложений из [корпуса C4](https://ai.googleblog.com/2020/02/exploring-transfer-learning-with-t5.html) и присвоили каждому предложению тег типа ошибки, чтобы их относительная частота соответствовала распределению тегов типов ошибок в небольшом наборе данных для разработки [BEA-dev](https://aclanthology.org/W19-4406.pdf). Поскольку [BEA-dev](https://aclanthology.org/W19-4406.pdf) — это тщательно подобранный набор, охватывающий широкий спектр различных уровней владения английским языком, ожидается, что распределение его тегов будет достаточно репрезентативным для ошибок, встречающихся в реальных текстах. Затем авторы использовали модель ухудшения качества с тегами для создания синтетического исходного предложения.

![image2](https://habrastorage.org/webt/ar/ja/hb/arjahbed8-uvsfluxw2zgz6e3eo.png)

*Генерация синтетических данных с тегированными моделями ухудшения качества. Правильные предложения C4 (отмечены зеленым) сочетаются с «испорченными» предложениями (отмечены красным) в синтетическом наборе данных для обучения GEC. Предложения с ошибками генерируются с использованием тегированной модели ухудшения качества текста в соответствии с частотами типов ошибок в наборе данных BEA-dev (см. гистограмму).*

# Результаты

В экспериментах авторов тегированные модели ухудшения качества текста превзошли модели без тегов на двух стандартных наборах данных ([CoNLL-13](https://aclanthology.org/W13-3601.pdf) и [BEA-dev](https://aclanthology.org/W19-4406.pdf)) более чем на три балла F0.5-меры ([стандартная метрика](https://aclanthology.org/P17-1074/) в исследованиях GEC, который сочетает в себе [точность и полноту](https://en.wikipedia.org/wiki/Precision_and_recall), где точность имеет больший вес), тем самым достигая самых высоких результатов на двух широко используемых в академических кругах тестовых наборах данных, [CoNLL-14](https://aclanthology.org/W14-1701.pdf) и [BEA-test](https://aclanthology.org/W19-4406.pdf).

Кроме того, использование тегированных моделей ухудшения качества текста не только демонстрирует прирост на стандартных тестовых наборах данных GEC, но и позволяет адаптировать системы GEC для более продвинутых пользователей языка. Это может быть полезно, например, потому что распределение тегов ошибок для авторов, являющихся носителями английского языка, часто значительно отличается от распределения для тех, кто изучал английский в качестве иностранного языка. Например, носители языка, как правило, делают больше пунктуационных и орфографических ошибок, в то время как ошибки в детерминативе (например, пропущенные или лишние артикли «a», «an» или «the») чаще встречаются в текстах авторов, не являющихся носителями языка.

# Заключение

Модели на основе нейронных сетей, работающие с последовательностями, как известно, требуют больших объемов данных, но наличие размеченных корпусов для обучения задаче исправления грамматических ошибок встречается редко. Новый [корпус C4_200M](https://github.com/google-research-datasets/C4_200M-synthetic-dataset-for-grammatical-error-correction) представляет собой синтетический набор данных, содержащий различные грамматические ошибки, который обеспечивает достижение самых высоких результатов при использовании его для предварительного обучения систем GEC. Публикуя этот набор данных, авторы надеются предоставить исследователям GEC ценный ресурс для обучения сильных базовых решений в создании систем исправления грамматических ошибок.

# Авторы

* **Автор оригинала** – Felix Stahlberg, Shankar Kumar
* **Перевод** – [Смирнова Екатерина](https://habr.com/ru/users/smekur/)
* **Редактирование и вёрстка** – [Шкарин Сергей](https://habr.com/ru/users/kouki_rus/)